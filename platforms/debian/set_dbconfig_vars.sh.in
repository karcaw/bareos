#!/bin/sh

# this script is inteaded to be sourced by 
# bareos-database-common postinstall script.
# It helps to configure dbconfig.

LIB=/usr/lib/bareos/scripts/bareos-config-lib.sh

if ! [ -r "$LIB" ]; then
    echo "failed to read library $LIB" >&2
else
    . $LIB

    #dbc_dbserver=
    #dbc_dbport=
    dbname=`get_database_name`
    dbuser=`get_database_user`
    bareos_database_password=`get_database_password`
    case "`get_database_driver`" in
        postgresql)
            dbtype="pgsql"
            # if Bareos config password is defined, set dbpass
            [ "$bareos_database_password" ] && dbpass="$bareos_database_password"
            ;;
        mysql)
            dbtype="mysql"
            # set dbpass, even if empty
            dbpass="$bareos_database_password"
            ;;
        sqlite3
            dbtype="sqlite3"
            # dbpass: not required
            ;;
    esac
fi
